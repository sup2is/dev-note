

# 후니의 쉽게 쓴 CISCO 네트워킹







# #1 네트워크 세상에 들어서며

## 네트워크가 없이도 잘 살던 시절이 있었습니다

## 이제는 인터넷 세상

## 네트워킹의 정체

- 네트워킹이란 서로 연결해서 대화할 수 있게 하는 것

## 인터넷, 인트라넷, 엑스트라넷

### 인터넷

- TCP/IP라는 프로토콜을 사용함

### 인트라넷

- 내부 네트워크
- TCP/IP 사용

### 엑스트라넷

- 인트라넷과 비슷하지만 내부뿐만아니라 외부도 어느정도 한정하면 엑스트라넷

# #2네트워크와 케이블, 그리고 친구들

## LAN(Local Area Network)이란?

- 어느 한정된 공간에서 네트워크를 구성할때 LAN을 씀
- PC방, 사무실 등
- WAN은 Wide Area Network LAN보다 넓은 개념

## 이더넷은 인터넷의 친구?

- 이더넷은 네트워킹의 한 방식임
- 이더넷의 가장 큰 특징은 CSMA/CD라는 프로토콜을 사용함
- 네트워킹 방식엔 이더넷 방식 말고도 토큰링, FDDI, ATM 방식도 있었음 어떤 방식을 사용하냐에 따라 랜카드를 비롯해여 하드웨어들이 다름
- CSMA/CD는 Carrier Sense Multiple Access/Collision Detection
- Carrier Sense 는 나트워크 자원을 쓰고 있는 pc나 서버가 있는지 확인해봄
- Multiple Access를 통해 2개 이상의 pc나 서버가 동시에 네트워크상에 데이터를 실어 보내는 경우가 발생함
- 부딪히면 충돌 감지 Collision Detection 충돌한다면 다시 기다린뒤 재전송

## 그럼 토큰링(TokenRing)은요?

- 토큰링 방식은 이더넷처럼 맘대로 보내지 않고 토큰을 갖고 있는 pc만 보낼 수 있음 <- 충돌이 없음 
- 단점은 다른 pc들이 유휴상태더라도 내가 토큰이 없으면 보낼 수 없음
- 이더넷의 발전으로 없어짐

## UTP 케이블만이라도 제대로 알아볼까요?

- Unshileded Twisted-pair UTP, STP 도 있음 Shileded

## 케이블, 이 정도만 알면 ...

- 10 Base T 에서 10은 속도 T는 거리를 나타냄
- 케이블 종류에 대한 자세한 설명은 생략
- 케이블의 경우 속도가 빨라지면 빨라질수록 전송 거리는 점점 짧아짐
- 광케이블은 통신을 위해 최소 2개의 코어가 필요함(송신, 수신)

## 맥 어드레스(Mac Address)에 대한 이야기

- 컴퓨터는 네트워크상에서 서로를 구분할 수 있도록 맥어드레스를 사용함
- 실제 ip 를 사용할 때는 ip를 맥어드레스로 변환시키는 ARP 프로토콜을 사용함
- 라우터가 없는 하나의 네트워크에서 PC A와 PC B가 통신을 필요로 할 때 PC A는 자기가 속한 네트워크에 브로드캐스트 메시지를 날림 이후 메시지를 받은 B가 A에게 자신의 맥 어드레스를 알려주면서 통신이 시작됨
- 라우터가 있는 다른 네트워크에서 통신할 때는 브로드캐스트로 통신 불가임 라우터는 브로드캐스트를 통과시키지 않음 자신의 네트워크에 PC B가 없다면 해당 라우터의 맥 어드레스를 .. 어쩌구 저쩌구 ..
- 맥 어드레스는 48bit의 주소를 갖고있음 이 주소는 랜카드 또는 네트워크 장비에 이미 고정되어 있는 주소이고 유일한 주소임 
- 모든 lan 디바이스들은 반드시 유일한 맥 어드레스를 가져야함
- 맥 어드레스는 16진수로 이루어져있음 : , - 형태로 구분
- 맥어드레스의 앞 6자리는 oui, 벤더사를 알 수 있음 그리고 나머지 6자리는 실제 시리얼 넘버

## 유니캐스트, 브로드캐스트, 멀티캐스트

### 유니캐스트

- 가장 많이 사용되는 트래픽의 형태
- 출발지와 목적지의 맥어드레스를 써놓는 방식
- 유니캐스트 프레임을 뿌리게되면 그 로컬 네트워크 상에 있는 모든 pc들은 일단 이 프레임을 받아들여서 자신의 랜카드에서 맥 어드레스를 비교함 만약 자신의 맥 어드레스가 맞지 않다면 그 프레임을 버림
- 브로드캐스트는 pc의 성능을 저하시키지만 유니캐스트는 pc의 cpu에까지는 영향을 주지 않음

### 브로드캐스트

- 브로드캐스트는 자신의 맥 주소와 상관 없이 일단 cpu에 패킷을 전달함 따라서 cpu의 성능 저하가 있을 수 있음
- 브로드캐스트는 ARP에서 주로 사용함 맥 어드레스를 모를때 상대편의 IP를 맥 어드레스로 변환할때 사용함

### 멀티캐스트

- 200명으 사용자가 있을때 150명에게만 같은 정보를 동시에 보내야 하는 상황이라고 가정했을 때 가장 쉽게 해결할 수 있는 방법
- 보내고자하는 그룹 멤버들에게만 한 번에 보낼 수 있음
- 라우터나 스위치에서 이 기능을 지원해줘야함

## OSI 7 Layer(레이어, 계층)는 왜 만들어졌나요?

- osi 7 계층
  - 피지컬
  - 데이터링크
  - 네트워크
  - 트랜스포트
  - 세션
  - 프레젠테이션
  - 애플리케이션
- osi 7 layer로 데이터의 흐름을 한 눈에 볼 수 있음
- osi 7 layer로 문제를 해결하기가 편리함
- 각 레이어마다 헤더를 붙이는 캡슐화 그리고 벗기는 언캡슐화가 반복적으로 나타남

## 컴퓨터는 프로토콜로 말한다

- 인터넷은 TCP/IP라는 프로토콜을 사용해야함

# #3 TCP/IP와의 만남

## TCP/IP를 모르면 인터넷을 아는게 아니다?

## 이 세상에서 나만을 위한 유일한 것

- 인터넷을 사용하는 우리에게는 모두 고유한 ip 주소를 갖고 있음
- 하지만 ip 부족 현상으로 NAT나 포트 넘버만 바꾸는 PAT방식이 사용됨
- 전 세계에 이런 공인 주소를 나눠주고 관리해주는 기관은 NIC Network Information Center 라는 곳

## 컴퓨터는 이진수로만 이해한다는데...

- ip 주소도 이진수임 이해하기 쉽도록 십진수로 변환한 것
- ip 부족 현상을 해결하기 위해 ipv6가 도입됨

## 이진수 계산 그 첫 번째

## 이진수 계산 그 두 번째

## DHCP

- Dynamic Host Configuration Protocol
- 네트워크의 모든 주소목록을 dhcp가 갖고 있다가 클라 pc가 켜지면서 네트워크에 브로드캐스트를 뿌림 그리고 자동으로 ip 주소를 할당 받음
- 요즘은 라우터에 기본적으로 있음

# #4 네트워크 장비에 관한 이야기

## 랜카드도 세팅해야 되나요?

- 랜에 접속하기 위해 필요한 카드
- 랜카드를 구매할 땐 자신의 pc가 PCI, ISA, EISA 인지 확인해봐야함
- 보통 메인보드나 이미 설치된 형태로 나옴
- 가장 대중화된게 UTP 케이블 꼽을 수 있는 형태의 랜카드
- 장치관리자 -> 네트워크 어댑터에서 사용하고 있는 어댑터를 선택하고 리소스를 확인해보면 IRQ가 있음 이 IRQ는 랜카드가 CPU에게 자기가 가지고 있던 IRQ를 이용해서 인터럽트를 걸게 됨

## 허브 이야기 그 첫 번째

- 같은 허브에 연결된 PC끼리는 서로통신이 가능함
- 구멍의 숫자에 따라 몇 포트 허브라고 불림
- 허브 역시 랜카드처럼 이더넷용 토큰링용이 있음
- 허브는 멀티포트 리피터라고 말할 수 있음 여러개의 포트와 들어온 데이터를 그대로 재전송한다는 의미를 가짐
- 리피터란 중간에서 들어온 데이터를 다른 쪽으로 전달해주는 역할을 함 리피터 자체로는 요즘 사용 안함
- 1~5 번pc가 있다고 가정할 때 1번 pc가 데이터를 허브를 통해 전송하면 허브에 들어온 데이터는 1번을 제외한 모든 pc에 전송됨 (랜카드에서 거름) 
- 이더넷 허브는 CSMA/CD의 적용을 받음

## 허브의 한계

- 가장 중요한건 안전성
- 허브에 속한 모든 PC들은 하나의 콜리전 도메인 안에 있어서 어느 한 순간에만 데이터를 보낼 수 있음 이런 기능을 수행하는 허브를 Shared 허브라 함
- 이 콜리전 도메인이라는 특성 때문에 pc가 많이 붙어있을 수록 좋지 않은 성능을 나타냄

## 허브 이야기 그 두 번째

- 인텔리전트 허브와 더미허브로 나뉨
- 인텔리전트 허브는 NMS를 통해서 관리가 됨. 모든 데이터를 분석할 수 있고 제어도 가능함
- 인텔리전트 허브는 CSMA/CD 의 특성으로 어떤 PC가 계속 이상한 데이터를 지속적으로 방출하면 다른 PC 모두 먹통이되는데 이때 문제의 PC가 연결된 포트를 찾아내어 자동으로 네트워크에서 분리시켜서 따로 고립시킬 수 있음 이 기능을 Auto Partition이라고하는데 요즘 더미허브에도 있음
- 스태커블 허브도 있음. 스테커블 허브는 여러 대가 스택으로 연결되면서 훨씬 더 좋은 성능을 발휘함

## 허브의 끝과 스위치의 시작

- 콜리전 도메인은 한 pc만 해당 콜리전 도메인 내부에서 데이터를 전송할 수 있음 따라서 콜리전 도메인이 커지는 것을 주의해야함
- 위 문제를 해결하기 위해 콜리전 도메인을 나누어 줄 수 있는 장비가 나왔는데 바로 브릿지, 스위치임
- 스위치가 나오기 전까지는 브릿지를 사용했음
- 스위치는 포트별로 콜리전 도메인이 나뉘어져 있음 허브와 스위치의 가장 큰 차이점은 어떤 pc가 통신할때 다른 pc도 통신이 가능한지임
- 스위치는 허브보다 속도도 빠르고 전송 에러 등을 복구해주는 등 여러가지 기능이 있음
- 트래픽에 따라 스위치, 허브를 결정해야함
- 스위치가 포트별로 콜리전 도메인이 나뉘어졌다고 하더라도 만약 집중적으로 한 곳과 통신한다면 허브와 속도는 별로 차이가 없음

## 험한 세상의 브릿지 되어 그대 지키리

- 스위치를 이해하기 위해서는 브릿지를 이해해야함
- 지속적으로 이야기하지만 허브는 하나의 콜리전 도메인 내부에서 여러 PC가 동시에 통신하는 것이 불가능함
- 브릿지는 허브로 만들어진 콜리전 도메인 사이를 반으로 나누고 중간에 다리를 놓는 방식
- pc 1~4가 있고 pc 1,2가 a 콜리전도메인, pc 3,4가 b 콜리전 도메인이라면 pc 1, 2가 서로 통신할때는 브릿지를 거치지 않음 그리고 이때는 b콜리전 도메인과 연관이 없기 때문에 pc 3, 4도 데이터 통신가능함 만약 1,3이 통신해야한다면 그때 브릿지를 거침

## 브리지/스위치의 기능

- 브릿지나 스위치는 다음 5가지일을 함
  - Learning 배운다
    - pc A가 통신을 위해 프레임을 내보내면 A의 맥 어드레스를 읽어서 자신의 맥 어드레스 테이블에 저장함 이후에 목적지가 A인 프레임에 전송할때 맥 어드레스 테이블을 사용함
  - Flooding 모르면 들어온 포트를 제외한 다른 모든 포트로 뿌린다
    - 프레임에 목적지 주소가 맥 어드레스 테이블에 없다면 자신을 제외하고 나머지 포트로 전부 뿌림
  - Forwarding 해당 포트로 건네준다
    - 목적지가 어디인지도 알고 있지만 출발지 세그먼트와 다른 세그먼트에 있다면 브릿지를 통해서 넘겨야함 이를 Forwarding이라함
  - Filtering, 다른 포트로는 못 건너가게 막는다
    - 목적지가 자신과 같은 세그먼트에 있다면 브릿지를 통할 필요가 없기 때문에 Filtering함 이는 콜리전 도메인을 나눠줄 수 있는 원리
  - Aging 나이를 먹는다
    - 맥어드레스 테이블은 일정 시간이 지나면 저장한 주소를 삭제함
- 브릿지와 스위치의 차이
  - 스위치는 하드웨어, 브릿지는 소프트웨어적 프레임 처리로 스위치가 더 빠름
  - 브릿지는 포트들이 같은 속도를 지원하고 스위치는 서로 다른 속도를 연결해줄 수 있는 기능을 제공함
  - 스위치는 제공하는 포트수가 더 많음
  - 스위치는 Cut-through, Store-and-forward 방식을 지원하는데 브릿지는 Store-and-forward 방법만 사용함
- 브릿지는 요즘에 보기 어려움

## Looping은 왜 생길까요

- 네트워크상에서 무한정으로 도는 현상 다른 전송에 막대한 피해를 미침
- 두개의 호스트와 두개의 스위치가 있고 A호스트는 스위치 A로도 바로 갈수있고 호스트 B로도 갈 수 있을때를 주의해야함
- 스패닝 트리 알고리즘을 적용하면 해결 가능함

## 스패닝 트리되지 않는 스위치는 팥 없는 찐빵!

- 스위치나 브리지에 두 개 이상의 경로가 만들어지만 치명적인 루핑이 발생함
- 스패닝 트리 알고리즘이란 스위치나 브리지에서 발생할 수 있는 루핑을 미리 막기 위해 두 개 이상의 경로가 발생하면 하나를 제외하고 나머지 경로를 자동으로 막아두었다가 기존 경로에 문제가 생기면 막아놓은 경로를 풀어서 데이터를 전송하는 알고리즘
- 스패닝 트리 알고리즘에 의해서 H/A가 동작하면 약 1분 이상이 걸림
- 요즘은 스패닝 트리 알고리즘 말고 이더 채널, 업링크 패스트라는 기술을 사용하나봄

## 라우팅이냐, 스위칭이냐?

- 라우터가 스위치보다 비쌈
- 스위치가 더 빠름 라우터는 내부에서 처리하는 일이 많음
- 스위치가 구성이 더 쉬움 라우터는 할게많음
- 라우터를 사용하는 이유
  - 브로드캐스트
    - 전세계가 하나의 브로드캐스트 영역으로 묶여있다면 전세계의 pc의 ARP를 감당해야함
    - 이런 브로드캐스트 영역을 나누기 위해 라우터가 반드시 필요함
    - 스위치 영역은 컬리전 영역만 관여하기 때문에 반드시 라우터로 구분시켜놔야함
  - 보안, 패킷 필터링 기능을 지원함
  - 로드밸런서



# #5 IP 주소로의 여행

## IP 주소 이야기 1탄

- TCP/IP에서 모든 장비들을 구분해주기 위해서 만들어낸 것이 IP주소

## 라우터에서 IP 주소 이해하기

- 내부 네트워크에 연결되는 라우터의 포트를 이더넷 인터페이스라고하고 외부, 인터넷쪽으로 연결되는 인터페이스를 시리얼 인터페이스라고 생각하면 됨
- 위 경우 IP 주소는 두개를 부여해야함, 이더넷 인터페이스에 하나, 시리얼 인터페이스에 하나
- 시리얼쪽은 상대편 라우터의 시리얼 인터페이스와 IP 주소를 서로 맞추어야함

## IP 주소 이야기 - 2탄

- 여기서 말하는 네트워크는 하나의 브로드캐스트 영역임 <- 하나의 PC가 데이터를 뿌렸을 때 그 데이터를 라우터를 거치지 않고도 바로 받을 수 있는 영역
- 다른 브로드캐스트영역에 있는 PC와 통신하려면 반드시 라우터를 거쳐야함
- 하나의 네트워크 안에서 네트워크 부분은 항상 동일하고 호스트는 모두 다른 IP 주소를 갖고 있어야함

## IP 주소 이야기 - 3탄

- IP 주소의 클래스는 5개가 있고 주로 3개만씀 A, B, C, D, E 네트워크 크기에 따른 구분, 하나의 네트워크가 호스트의 수를 몇 개까지 가질 수 있는가에 따라서 클래스가 나뉨
- 클래스 A는 네트워크가 가질 수 있는 호스트 수가 가장 많은 클래스, 1부터 126으로 시작하는 네트워크는 A 클래스임 16,777,214개
- 클래스 B는 128부터 191로 시작하는 네트워크 클래스 65,534개
- 클래스 C는 192부터 223으로 시작하는클래스 254개

## IP 주소의 활용

- TCP/IP 통신할 경우 라우터의 각 인터페이스 역시 IP 주소를 부여해주는 것이 좋음 이 경우 하위에 들어올 호스트의 수를 모두 포함할 수 있는지를 확인해야 함
- 내부 네트워크에서는 라우터 없이도 통신이 가능하지만 외부로 나갈때는 게이트웨이가 필요함 이때 이 게이트웨이 주소는 라우터의 이더넷 인터페이스 주소가 되어야함
- 라우터에는 인터페이스별로 각각 ip가 있어야하지만 스위치나 허브는 관리용으로 지정하는 것이지 지정하지 않아도 통신가능함

## 서브넷 마스크의 시작

- 서브넷마스크는 메인이 아닌 어떤 가공을 통한 네트워크를 만들기 위해서 씌우는 마스크
- 만약 B클래스를 그냥 사용한다면 하나의 네트워크에서 65000여개의 호스트의 브로드캐스트를 감당할 수 없음
- 부여받은 ip에서 다시 서브넷마스크로 네트워크를 나눌 수 있음
- 서브넷마스크로 네트워크 영역을 나누면 브로드캐스트 영역을 나누는것과 똑같음 결론적으로 라우터가 중간에 있음

## 서브넷 마스크에도 기본은 있다

- 모든 ip 주소에는 서브넷 마스크가 따라다님 
- 예를 들어 C클래스를 서브넷마스크로 쪼개지 않더라도 기본 서브넷 마스크는 255.255.255.0 임
- B클래스는 255.255.0.0, A클래스는 255.0.0.0
- 서브넷 마스크는 ip주소를 가지고 어디까지가 네트워크 부분이고 또 어디까지가 호스트 부분인지를 나타내는 역할을 함
- 서브넷 마스크가 이진수로 1인 부분이 네트워크가 되고 0인 부분이 호스트가 된다는 것만 기억하면 됨(옥텟으로 나눴을때)
- B클래스 150.150.100.0 에 서브넷마스크 255.255.255.0을 적용하면 마치 C클래스 주소처럼 사용하는 것 150.150.100 부분이 네트워크고 나머지 부분이 호스트임

## 서브넷 마스크의 기본 성질

- 서브넷 마스크로 만들어진 네트워크, 서브넷은 이제 하나의 네트워크이기 때문에 서로 나뉜 서브넷끼리는 라우터를 통해서만 통신이 가능함
- 예를들어 기본 서브넷마스크 255.255.0.0을가진 150.100.100.1 과 150.100.200.1은 라우터를 거치지 않고 통신이 가능함 만약 서브넷을 255.255.255.0으로 줬다면 네트워크 부분이 달라지기 때문에 서로 통신이 불가능함 이 경우 두 네트워크로 분리되었기 때문에 라우터를 거쳐야만 통신이 가능함
- 서브넷 마스크로 나눠진 네트워크는 독립적인 네트워크로 됨
- 서브넷 마스크는 이진수로 썼을 때 1이 연속적으로 나와야함 
- 서브넷으로 나누는 것은 브로드캐스트 도메인을 줄이기 위한 것

## 서브넷 마스크, 그 속으로...

- 호스트부분에서 0과 255는 사용할 수 없음
- 서브넷에서 호스트의 개수를 구하는 공식은 2의 호스트 비트 수 승의 - 2 형태 예를들면 30개가 필요하다면 2의 5승 - 2를 하면 30임
- 만약 C클래스 ip 210.100.1 네트워크에서 30개 호스트를 갖는 4개의 서브넷을 나눈다고 하면 다음과 같이 서브넷을 210.100.1 1110 0000 -> 10진수로 210.100.1.224로 구성할 수 있음
- 1인 부분이 네트워크 0인부분이 호스트만 기억하면
- 1110 0000 에서 111은 서브넷 0 0000은 호스트의 수 예를 들면 210.100.1.0000 0001 에서 210.100.1.0001 1110까지 하나의 서브넷에 속함

## 서브넷 마스크에 대한 시험

## IP와 서브넷에 대한 정리

- IP주소는 총 5개의 클래스 A B C D E 가있고 A B C 만 사용함
- 서브넷을 만드는 목적은 IP 주소를 보다 효율적으로 낭비없이 쓰기 위함과 적정한 주소 배정을 위함임

# #6 스위치를 켜라!

## 스위치와 브리지

- 스위치랑 브릿지는 비슷함 요즘은 스위치만 있음

## 스패닝 트리로 가는 첫 번째 관문 2가지

- 스패닝 트리 알고리즘은 루핑을 막아주기 위한 프로토콜
- 스패닝 프로토콜을 이해하기위한 2가지 개념
  - 브릿지 ID
    - 16bit bridge priority + 48bit mac address
    - bridge priority 는 32768가 기본값
  - Path Cost
    - 네트워크의 경로 (속도)
    - 링크의 속도가 다양해지면서 IEEE에서 소수점이 나오지 않도록 Path Cost 값을 지정해놓음
    - 10Mpbs -> 100 Path Cost , 100Mbps -> 19 Path Cost ....

## 스패닝 트리를 잘하려면 3가지만 기억하세요!

- 스패닝트리 3가지공식
  1. 네트워크당 하나의 루트 브릿지를 갖는다
     - 여기서 말하는 네트워크는 스위치나 브릿지로 구성된 하나의 네트워크
  2. 루트 브릿지가 아닌 나머지 모든 브릿지는 무조건 하나씩의루트 포트를 갖는다
     - 루트 포트란 루트 브릿지에 가장 빨리 갈 수 있는 포트
  3. 세그먼트당 하나씩의 데지그네이티드 포트를 갖는다.
     - 세그먼트는 브릿지 또는 스위치 간의 연결 링크 그렇다면 연결된 두 스위치중 한개 포트는 데지그네이티드 포트여야함
  4. 
- 스패닝 트리 프로토콜에서 루트 포트나 데지그네이티드 포트가 아닌 나머지 모든 포트는 다 막어버림

## 누가 누가 더 센가? STP에서 힘 겨루기

- 누가 루트브릿지가 될 지, 데지그네이티드 포트의 결정 방법
  1. 누가 더 작은 Root BID를 가졌는가?
  2. 루트 브리지까지 Path Cost 값은 누가 더 작은가?
  3. 누구의 BID가 더 낮은가?
  4. 누구의 포트 ID가 더 낮은가?
- 브릿지나 스위치는 스패닝 트리 정보를 자기들끼리 주고 받기 위해 특수한 프레임을 사용하는데 이를 BPUD 라함 Bridge Protocol Data Unit
- BPUD는 매 2초마다 주고받음
- BPUD
  - Root BID
  - Root Path Cost
  - Sender BID
  - Port ID

## 스위치에서 대장 브리지 뽑기

- 낮은 bid를 갖는 녀석이 대장브릿지가됨
- 스위치가 부팅하면 BPUD를 주고받게됨 이때 루트 브릿지에 대한 정보가 없으므로 BPUD의 RootBID는 자신의 BID를 넣어서 보냄 만약 다른 스위치가 BID가 더 낮다면 BPUD의 Root BID를 변경함
- 특정한 스위치를 루트 브릿지로 만들고싶다면 BID를 변경하면 됨

## 졸병 브리지(Non Root Bridge)의 루트 포트 선출기

- 루트포트는 루트 브릿지에 가장 가까이 있는 포트를 말함
- Path Cost에 의해 결정됨

## 스패닝 트리의 마지막 단계 데지그네이티드 포트(Designated Port) 뽑기

- 스위치와 스위치로 연결된 세그먼트당 각각 한 개의 데지그네이티드 포트를 뽑아야함
- 루트 브릿지의 모든 포트들은 언제나 데지그네이티드 포트로 선정됨
- 일반 넌 루트 브릿지 포트들은 다음의 경합과정으로 데지그네이티드 포트를 결정함
  1. 누가 더 작은 Root BID를 가졌는가?
  2. 루트 브리지까지 Path Cost 값은 누가 더 작은가?
  3. 누구의 BID가 더 낮은가?
  4. 누구의 포트 ID가 더 낮은가?

## 스패닝 트리 프로토콜의 5가지 상태 변화

- 스패닝트리를 만드는 간단한 과정
  - 루트브릿지하나 뽑기
  - 루트브릿지를 제외한 나모지 모든 브릿지에서 루트 포트를 뽑고
  - 데지그네이티드 포트를 뽑은 후 마지막으로 나머지 포트는 Non 데지그네이티드 포트로 지정하면 됨
- 스패닝 트리 프로토콜을 구현해나가는 과정에서 모든 스위치나 브릿지의 포트들은 언제나 5가지 상태로 변함
  - Disabled
    - 포트가 고장나서 사용할 수 없거나 네트워크 관리자가 일부러 다운시켜 놓은 상태
    - 데이터전송 X, BPUD X, 맥어드레스 테이블 X
  - Blocking
    - 스위치를 맨 처음 켜거나 Disabled 되어있는 포트를 다시 살렸을때 블로킹상태로 들어감
    - BPUD만 주고받을 수 있음
    - 데이터전송 X, BPUD O, 맥어드레스 테이블 X
  - Listening
    - 블로킹상태에서 루트포트, 데지그네이티드 포트로 선정되면 리스닝 상태로 넘어감
    - 스위치 상황이 바뀌면 언제든 Non 데지그네이티드 포트로 선정될 수 있음
    - 데이터전송 X, BPUD O, 맥어드레스 테이블 X
  - Learning
    - 리스닝 상태에 있던 스위치 포트가 포워딩 딜레이 디폴트 시간인 15초동안 그 상태를 계속 유지하면 러닝 상태로 넘어감
    - 데이터전송 X, BPUD O, 맥어드레스 테이블 O
  - Forwarding
    - 러닝상태에서 다른 상태로 넘어가지 않고 15초를 버티면 포워딩 상태로 넘어옴
    - 데이터전송 O, BPUD O, 맥어드레스 테이블 O

## 배운거 써먹기 - 직접 한번 구성해 보자구요!

## 스패닝 트리에 변화가 생기던 날

- 만약 Non 루트 브릿지들이 지정된 시간 동안 루트 브릿지의 패킷을 받지 못하면 중간 경로에 뭔가 문제가 발생했다고 생각하고 스패닝 트리를 재편성하는 모드로 들어가게 됨
- 스패닝 트리의 재편성에 필요한 용어
  - Hello Time
    - 루트 브릿지가 얼마 만에 한 번씩 헬로 BPDU를 보내는지에 대한 시간
    - 디폴트 2초
  - Max Age
    - 브릿지들이 루트 브릿지로부터 헬로 패킷을 받지 못하면 맥스 에이지 시간 동안 기다린 후 스패닝 트리 구조 변경을 시작함
    - 디폴트 20초
  - Forwarding Delay
    - 브리지 포트가 블로킹 상태에서 포워딩 상태로 넘어갈때까지 걸리는 시간
- 만약 루트브릿지와 브릿지사이에 연결이 끊겼다면 Max Age 시간만큼을 기다리고 스패닝 트리의 변경을 시작함
- 브릿지 - 브릿지 사이에 연결된 블로킹된 포트가 BPDU를 받고 있기 때문에 리스닝 -> 러닝15초 -> 포워딩15초 상태로 넘어가고 기존에 연결되었었지만 끊어졌던 루트포트는 블로킹상태가됨

## 카타리스트 스위치 바라보기

- 시스코 장비중에 카타리스트 스위치가 있음
- PoE Power over Ethernet : 이더넷 케이블 + 전원 케이블

## 카타리스트 스위치 구성하기

- 스패닝 트리 프로토콜은 자동설정되어 있음
- 스위치는 굳이 ip 주소를 설정하지 않아도 동작하지만 관리를 위해 지정함
- 이외는 실제 장비 셋팅이여서 생략

## 맥 어드레스는 어디에 저장되어 있을까요?

- 시스코 시위치가 맥 어드레스를 저장하는 방식은 크게 2가지 
  - Dynamic 방식
    - 디폴트 방식
    - 300초를 기다리고 더이상 통신이 없으면 잊어버림 300초가 기본값
  - Permanent 방식
    - 맥 어드레스가 절대 지워지지 않음

## 가상의 랜이란?

- 예전에는 스위치가 단순히 콜리전 영역을 나눠주는 정도의 역할만 하면 충분했음
- VLAN을 사용하면 한 대의 스위치를 마치 여러 대의 분리된 스위치처럼 사용하고, 또 여러 개의 네트워크 정보를 하나의 포트를 통해 전송할 수 있음
- VLAN을 이용하면 스위치에 연결된 장비들도 브로드캐스트 도메인이 서로 다를 수 있음
- 라우터는 네트워크 개수만큼 이더넷 인터페이스가 필요함

## VLAN에서 꼭 기억해야 할 몇 가지

- VLAN은 스위치에서 지원하는 기능
- VLAN은 한 대의 스위치를 여러 개의 네트워크로 나누기 위해서 사용함
- 스위치가 일단 VLAN으로 나누어지면 나우어진 VLAN 간의 통신은 오직 라우터를 통해서만 가능함
- 한대의 스위치가 여러개의 VLAN으로 나눌 수 있음
- 하나의 포트를 통해 서로 다른 여러 개의 VLAN을 전송할 수 있게 하는 포트를 트렁크 포트라고 함
- 트렁크 포트로 VLAN은 여러대의 스위치로 구성 가능
- 스태틱 VLAN은 가장 일반적인 방식, 스위치의 각 포트들을 원하는 VLAN에 하나씩 배정해주면 됨 
- 다이내믹 VLAN은 포트별로 고정 VLAN을 배정하는것이 아니라 그 포트에 접속하는 장비의 맥 어드레스를 보고 그 주소에 따라 VLAN을 달리 배정하는 방식

## VLAN에서의 트렁킹과 VTP(VLAN Trunking Protocol)

- 트렁킹은 여러 개의 VLAN 들을 함께 실어나르는 것을 말함
- 각 스위치에 여러개의 VLAN이 있어서 각 VLAN 별로 링크를 만들어줘야하는데 이런부분을 트렁킹으로 해결함
- 각 VLAN들은 트렁킹이라는 셔틀버스에 자기들의 패킷에 이름표를 붙임 ISL방식과 IEEE 802.1Q방식이 있음
- 네이티브 VLAN은 패킷에 VLAN 정보를 붙이지 않고 보내는 유일한 VLAN
- 강조하지만 다른 VLAN에 속해 있다면 라우터를 통해서만 통신 가능함
- 시스코 VTP가 있음 참고

## VLAN의 구성

- 스킵

## 실제 상황! VLAN

# #7 라우터만 알면 네트워크 도사?

## 라우터를 한마디로 말하자면...

## 라우터는 무슨 일을 할까요?

## 라우터는 어떻게 생긴 녀석일까요?

## 라우팅 프로토콜과 라우티드 프로토코

## 스태틱 라우팅 프로토콜과 다이내믹 라우팅 프로토콜

## 라우팅 테이블에 대한 이야기

## AS, 그리고 내부용과 외부용 라우팅 프로토콜

## 라우터 구성의 시작

## 라우터의 중요한 몇 가지 모드

## 라우터 안에는 어떤 것들이 살까요?

## 내가 가진 라우터의 현재 정보는 모두 이곳에!

## 라우터 셋업 모드

## 라우터에 명령을 입력하는 두 번째 방법

## 스태틱(Static) 라우팅을 이용한 라우팅 구성

## 스태틱 라우팅만 알면 디폴트 라우트는 식은 죽 먹기

## 라우터의 구성 명령에 대한 버전별 정리

## 디스턴스 벡터와 링크 스테이트

## 라우터의 패스워드 구성

## 시스코 라우터의 친구 찾기 CDP

## 텔넷을 이용한 장비 접속

## 핑과 트레이스





# 